### ![goup.png](http://html-applications.bitbucket.org/images/goup.png) [Return to HTML Application page](http://html-applications.bitbucket.org) ###
---
## ![ptkpsd.png](http://html-applications.bitbucket.org/images/ptkpsd.png)  [ПТК ПСД - Обозреватель отчетности](http://html-applications.bitbucket.org/ptkpsd-browser/readme.html) ##
Наглядный просмотр и работа с архивом посылок ПТК ПСД. Смотрите также проект [SVK Transport](https://bitbucket.org/html-applications/svk-transport) для их доставки.

![Рабочее окно приложения](screen.png)

Данное HTA-приложение предназначено для просмотра архива посылок ПТК ПСД.
Хотя в ПТК ПСД присутсвует такая возможность (кнопка с зеленой буквой "М" на панели инструментов по которой открывается поиск в архиве) но ущербность этой реализации подтолкнула меня на написание отдельной утилиты.

### Основные возможности программы

* быстрый и наглядный просмотр всей корреспонденции. Так, например, видно отчеты по какой форме содержатся в SA-посылках;
* фильтрация по типу посылки и интервалу дат;
* встроенный просмотр содержимого упакованных архивов (независимо от уровня вложенности!);
* анализ и подсветка ключевого содержимого посылки (дата, принят или нет и т.п.);
* контроль ключа аутентификации;
* возможность выгрузки в файл и печати любого сообщения;
* возможность моментального формирования подтверждений на решения 365-П;
* гибкие настройки;

### Замечания к использованию

* До первого запуска программы внимательно изучите и отредактируйте PTK_PSD_Browser.ini.
* Никаких ухищрений для защиты от дебильных антивирей не предпринималось, поэтому если пользуетесь одним из них, заносите программу в список исключений.

### Загрузка

* [Дистрибутив](https://bitbucket.org/html-applications/ptkpsd-browser/downloads)
* [Исходный код](https://bitbucket.org/html-applications/ptkpsd-browser/src)

### История версий

Все последующие изменения смотрите на странице [Changes](https://bitbucket.org/html-applications/ptkpsd-browser/commits/all)

* 3.7.1 Параметр sign_delete_onsave в ini-файле принимает теперь значения 0 или 1. Невозможно было вручную задать интервал дат в 12 месяце. Архиватор 7zip обновлен до версии 9.20.
* 3.7.0 В поле предпросмотра появилось контекстное меню для выгрузки отдельных документов из посылки. Дополнительные настойки в ini файле. Проверка ручного ввода даты. Другие исправления.
* 3.6.14 Наименования форм, входящих в SA-посылку, распознаются более корректно. Распознаются все формы Санкт-Петербургского и Нижегородского РЦИ.
* 3.6.13 Выборка за заданный вручную интервал теперь обновляется при подтверждении ввода даты клавишей Enter (раннее обновление происходило при потере фокуса на любом из полей ввода). Изменен вид курсора в контекстном меню.
* 3.6.12 Публикация программы на googlecode. Небольшая косметическая правка.
* 3.6.11 Упрощена процедура поиска и удаления ЭЦП.
* 3.6.10 Если содержимое 311П нераспознано, то кол-во документов в посылке не показывается. Раньше при наличии в архиве нечитабельных посылок возникал сбой.
* 3.6.9 Даты, найденные в теле документа, подсвечиваются.
* 3.6.8 Bugfix
* 3.6.7 Кол-во файлов в ОЭС и ИЭС2 для формы 311П отображается в списке.
* 3.6.6 Ранее содержимое SA посылки ИЭС2 формы 308П не отображалось в списке.
* 3.6.5 В списке для решений 322П показывается кол-во документов, входящих в пакет.
* 3.6.4 В список добавлены иконки отправленной/принятой корреспонденции (для наглядности).
* 3.6.3 При выборе радиобуттоном ручного периода происходил лишний рефреш списка.
* 3.6.2 Файлы, показываемые в окне быстрого просмотра теперь проверяются не только по расширению, но и по наличию в содержимом служебных символов, затем чтобы вместо нечитабельного содержимого вывести "-содержимое скрыто-".
* 3.6.1 При отсутствии соответствующего файла отчетности в Store в панель быстрого просмотра выводится предупреждение и совет отказаться от встроенного архивирования.
* 3.6.0 Переписана процедура выполнения SQL запросов. Теперь она возвращает не текст, а готовую таблицу.
* 3.5.5 Теперь до отправки квитанции и подтверждения, посылка ИЭС1 решения 322p имеет статус "не принят"
       (флаг устанавливается в БД с помощью PTK_PSD_Monitor v2.2.2).
       При отправке квитанции и подтверждения статус соответствующей входящей посылки изменяется на "принят".
* 3.5.4 Вернулся на прежнюю версию 7zip, т.к. консольная не может распаковывать arj
* 3.5.3 Номер к пояснительной записке к форме 212 (Z745212.doc не упакованный в zip) не отображался в списке SA посылок.
       Символ "Z" в имени файла не отображался.
       7zip 9.07 beta пытался распаковывать doc файл (заменен на версию 4.65 2009-02-03 для командной строки)
* 3.5.2 Исправлена ошибка, возникавшая при неверном выборе интервала дат.
* 3.4.5 Исправлена ошибка с форматом даты, в результате которой с 1 по 9 число приложение выдавало ошибку.
* 3.4.3 C помощью *Дмитрия Евдокимова* (Санкт-Петербург) отлажена работа обозревателя с MSSQL базами.
       Теперь вместо длинного перечня форм, доступных пользователю, достаточно указать его имя.
       Корректно отображается КА для документов, подписанных Сигнатурой (раньше работало только с Вербой).
       Куча других мелких исправлений.
* 3.2.13 Исправлены ошибочки, найденные пользователями. Так, например, раньше некоторые из SA посылок в списке отображались безлико (как в ПТК ПСД) - было не видно отчет по какой форме в них содержится.
* 3.2.8 Исправлена ошибка, найденная SharkyVan: "При выборе Периода (например, "Вчера" или "за три дня") нужно нажимать именно на радиобуттон, если жмякнуть на надпись, то отбор не происходит, хотя точка перескакивает."
* 1.0.0 С чего это все начиналось ???

### Лицензионное соглашение

Приложение распространяется по лицензии [Donationware](http://ru.wikipedia.org/wiki/Donationware).
Вы можете использовать его совершенно свободно без всяких ограничений.

Так же Вы можете поощрить автора и стимулировать его на дальнейшее развитие программы.

Номера моих кошельков в сиcтеме WebMoney: *Z222067118596* (WMZ), *R117579193804* (WMR) ([способы пополнения](http://www.webmoney.ru/rus/addfunds/))

Номер моего счета в Яндекс.Деньги: *41001863628372* ([способы пополнения](http://money.yandex.ru/prepaid/))

Данные для обратной связи находятся в коде заголовка HTA приложения.